SELECT L.*
FROM (SELECT PATTERN FROM CTX GROUP BY PATTERN) CP
JOIN CTX C
ON
	C.LINE IN (
		SELECT max(LINE)
		FROM CTX
		WHERE PATTERN = CP.PATTERN
	)
JOIN LOG L
 ON L.LINE = C.LINE